#!/usr/bin/env ruby

require 'pathname'


ENV['BUNDLE_GEMFILE'] ||= File.expand_path("../../Gemfile", Pathname.new(__FILE__).realpath)

$LOAD_PATH.unshift File.expand_path('../../lib/validator', Pathname.new(__FILE__).realpath)


require 'bundler/setup'
require 'optparse'
require 'repo_validator'
require 'downloader'

internet = 'default'
OptionParser.new do |opts|
  opts.on("-d", "--[no-]download", "Download books.yaml and manuscripts.yaml from github") do |d|
    internet = d
  end 
   opts.on("-h", "--help", "Prints this help") do
     puts opts
     exit
   end
end.parse!

case internet
when 'default'
  Downloader.new.run
when true
  Downloader.new(force: true).run
end 

puts  RepoValidator.new.validate
